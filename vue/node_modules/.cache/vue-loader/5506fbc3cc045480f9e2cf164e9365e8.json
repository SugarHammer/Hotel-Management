{"remainingRequest":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\GitHub\\smart-hotel\\vue\\src\\views\\Contract.vue?vue&type=style&index=0&id=3f466b68&lang=css","dependencies":[{"path":"E:\\GitHub\\smart-hotel\\vue\\src\\views\\Contract.vue","mtime":1677826204889},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgLmVsLWNhcm91c2VsX19pdGVtOm50aC1jaGlsZCgybikgewogICAgYmFja2dyb3VuZC1jb2xvcjogIzk5YTliZjsKICB9CiAgCiAgLmVsLWNhcm91c2VsX19pdGVtOm50aC1jaGlsZCgybisxKSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDNkY2U2OwogIH0KICAudGltZSB7CiAgICBmb250LXNpemU6IDEzcHg7CiAgICBjb2xvcjogIzk5OTsKICB9CiAgCiAgLmJvdHRvbSB7CiAgICBtYXJnaW4tdG9wOiAxM3B4OwogICAgbGluZS1oZWlnaHQ6IDEycHg7CiAgfQoKICAuYnV0dG9uIHsKICAgIHBhZGRpbmc6IDA7CiAgICBmbG9hdDogcmlnaHQ7CiAgfQoKICAuaW1hZ2UgewogICAgd2lkdGg6IDEwMCU7CiAgICBkaXNwbGF5OiBibG9jazsKICB9CgogIC5jbGVhcmZpeDpiZWZvcmUsCiAgLmNsZWFyZml4OmFmdGVyIHsKICAgICAgZGlzcGxheTogdGFibGU7CiAgICAgIGNvbnRlbnQ6ICIiOwogIH0KICAKICAuY2xlYXJmaXg6YWZ0ZXIgewogICAgICBjbGVhcjogYm90aAogIH0K"},{"version":3,"sources":["E:\\GitHub\\smart-hotel\\vue\\src\\views\\Contract.vue"],"names":[],"mappings":";EA0SE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IAC/B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3B;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACjC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3B;EACA,CAAC,CAAC,CAAC,CAAC,EAAE;IACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACnB;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;IACV,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACd;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACL,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAChB;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EACf;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACd","file":"E:/GitHub/smart-hotel/vue/src/views/Contract.vue","sourceRoot":"","sourcesContent":["<template>\n  <div style=\"padding: 10px\">\n    <!--    搜索区域-->\n    <div style=\"margin: 10px 0\">\n      <el-divider content-position=\"left\">查询条件</el-divider>\n      <span>下单客户用户名：</span><el-input v-model=\"search\" placeholder=\"请输入下单客户用户名\" style=\"width: 30%\" clearable></el-input>\n      <el-button type=\"primary\" style=\"margin-left: 5px\" @click=\"findall\">查询<i class=\"el-icon-search el-icon--right\"></i></el-button>\n      <el-button @click=\"drawer = true\" type=\"primary\" style=\"margin-left: 16px;\">\n        用户下单\n      </el-button>\n    </div>\n\n    <el-divider content-position=\"left\">合约列表</el-divider>\n    <el-table\n    :data=\"contract\"\n    border\n    stripe\n    style=\"width: 100%\">\n    <el-table-column\n      fixed\n      prop=\"conId\"\n      label=\"ID\"\n      width=\"100\"\n      sortable>\n    </el-table-column>\n    <el-table-column\n      prop=\"userName\"\n      label=\"下单用户\"\n      width=\"100\">\n    </el-table-column>\n    <el-table-column\n      prop=\"createTime\"\n      label=\"下单时间\"\n      width=\"200\">\n    </el-table-column>\n    <el-table-column\n      prop=\"terminTime\"\n      label=\"解约时间\"\n      width=\"200\">\n    </el-table-column>\n    <el-table-column\n      prop=\"adminName\"\n      label=\"下单方\"\n      width=\"100\">\n    </el-table-column>\n    <el-table-column\n      prop=\"apartmentName\"\n      label=\"下单酒店\"\n      width=\"200\">\n    </el-table-column>\n    <el-table-column\n      prop=\"roomName\"\n      label=\"下单房间\">\n    </el-table-column>\n    <el-table-column label=\"操作\" width=\"400\">\n        <template #default=\"scope\">\n          <el-popconfirm title=\"确定解约吗？\" @confirm=\"handleDelete(scope.row.conId)\">\n            <template #reference>\n              <el-button size=\"mini\" type=\"danger\">解约</el-button>\n            </template>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n  </el-table>\n\n  <div style=\"margin: 10px 0\">\n      <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"currentPage\"\n          :page-sizes=\"[5, 10, 20]\"\n          :page-size=\"pageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\">\n      </el-pagination>\n  </div>\n\n  <el-drawer\n  title=\"用户下单中心\"\n  :before-close=\"handleClose\"\n  v-model=\"drawer\"\n  direction=\"rtl\"\n  size=\"60%\"\n  custom-class=\"demo-drawer\"\n  ref=\"drawer\"\n  >\n      <el-card>\n        <el-form ref=\"form\" :model=\"form\" label-width=\"120px\" :rules=\"rules\">\n          <el-form-item label=\"下单中心\">\n          </el-form-item>\n          <el-form-item label=\"选择下单用户\">\n            <el-select v-model=\"form.userId\" \n              placeholder=\"试试搜索：用户名\"\n              :options=\"options\"\n              filterable\n              style=\"width: 90%; margin: 10px\">\n              <el-option v-for=\"item in this.users\" :key=\"item.id\" :label=\"item.truename\" :value=\"item.id\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"选择房间\">\n            <el-select v-model=\"form.roomId\" \n              placeholder=\"试试搜索：房间号\"\n              :options=\"options\"\n              filterable\n              style=\"width: 90%; margin: 10px\">\n              <el-option v-for=\"item in this.rooms\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"选择租约时间:\">\n            <el-date-picker style=\"width: 90%; margin: 10px\"\n              v-model=\"form.time\"\n              type=\"datetimerange\"\n              value-format=\"YYYY-MM-DD HH:mm:ss\"\n              range-separator=\"至\"\n              start-placeholder=\"开始日期\"\n              end-placeholder=\"结束日期\"\n              align=\"right\">\n            </el-date-picker>\n          </el-form-item>\n        </el-form>\n        <div style=\"text-align: center\">\n          <el-button type=\"primary\" style=\"width: 80%; margin: 10px\" @click=\"saveContract\">签   约</el-button>\n        </div>\n      </el-card>\n    <div style=\"width: 100%;height:10px\"></div>\n      <el-card>\n        <el-image\n          style=\"width: 100px; height: 100px\"\n          :src=\"this.room.pic\"\n          :preview-src-list=\"[this.room.pic]\">\n          >\n        </el-image>\n          <div style=\"padding: 14px;\">\n            <span>房间名：{{ this.room.name }}</span>\n            <br>\n            <span>房间价格：{{ this.room.price }} 元/天</span>\n            <br>\n            <span>所属酒店：{{ this.room.apartmentName }}</span>\n            <br>\n          </div>\n      </el-card>\n      <div style=\"width: 100%;height:10px\"></div>\n      <el-card>\n        <el-image\n          style=\"width: 60px; height: 60px; border-radius: 50%\"\n          :src=\"this.user.avatar\"\n          :preview-src-list=\"[this.user.avatar]\">\n          >\n        </el-image>\n          <div style=\"padding: 14px;\">\n            <span>下单人姓名：{{ this.user.truename }}</span>\n            <br>\n            <span>下单人身份证号：{{ this.user.idcode }}</span>\n            <br>\n            <span>下单人电话：{{ this.user.telephone }}</span>\n            <br>\n          </div>\n      </el-card>\n  </el-drawer>\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\n  export default {\n    name: 'Contract',\n    components: {},\n    data() {\n      return {\n        loading: true,\n        drawer: false,\n        form: {\n          roomId: '',\n          userId: '',\n          createTime: '',\n          terminTime: '',\n          apartmentId: ''\n        },\n        search: '',\n        userform: {},\n        user:{},\n        room:{},\n        users: [],\n        rooms: [],\n        contract: [],\n        rules: {\n          userId: [\n            {required: true, message: '请选择入住人', trigger: 'blur'},\n          ],\n          roomId: [\n            {required: true, message: '请选择房间', trigger: 'blur'},\n          ],\n          time: [\n            {required: true, message: '请选择租约时长', trigger: 'blur'},\n          ], \n        },\n      }\n    },\n    watch: {\n      'form.roomId':{\n        handler(val){\n          this.findRoom(val)\n        },\n      },\n      'form.userId':{\n        handler(val){\n          this.findUser(val)\n        },\n      },\n      deep: true,\n      immediate: true\n    },\n    created() {\n      let str = sessionStorage.getItem(\"user\") || \"{}\"\n      this.userform = JSON.parse(str)\n      this.findall();\n      this.findalluser();\n      this.findallroom();\n    },\n    methods: {\n      findall(){\n        this.loading = true\n          request.get(\"/contract/all\", {\n            params: {\n              pageNum: this.currentPage,\n              pageSize: this.pageSize,\n              search: this.search,\n              adminId: this.userform.id                                                                                                                                                                                                                                                                                                    \n            }\n          }).then(res => {\n            this.loading = false\n            this.contract = res.data.records\n            this.total = res.data.total\n          })\n      },\n      findRoom(id){\n        console.log(id)\n        request.get(\"/room/\"+id).then(res => {\n             this.room = res.data\n          })\n      },\n      findUser(id){\n        console.log(id)\n        request.get(\"/user/\"+id).then(res => {\n             this.user = res.data\n          })\n      },\n      findalluser(){\n        request.get(\"/contract/alluser\").then(res => {\n             this.users = res.data\n          })\n      },\n      findallroom(){\n        request.get(\"/contract/allroom/\"+this.userform.id).then(res => {\n             this.rooms = res.data\n          })\n      },\n      saveContract(){\n        this.form.createTime = this.form.time[0]\n        this.form.terminTime = this.form.time[1]\n        this.form.adminId = this.userform.id\n        request.post(\"/contract/add\",this.form).then(res => {\n            if (res.code === '0') {\n              this.$message({\n                type: \"success\",\n                message: \"下单成功\"\n              })\n              window.open(res.data)\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              })\n            }\n        })\n      },\n      handleDelete(id) {\n        request.delete(\"/contract/\" + id).then(res => {\n          if (res.code === '0') {\n            this.$message({\n              type: \"success\",\n              message: \"删除成功\"\n            })\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg\n            })\n          }\n          this.findall()  // 删除之后重新加载表格的数据\n        })\n      },\n    }\n  }\n</script>\n\n<style>\n  .el-carousel__item:nth-child(2n) {\n    background-color: #99a9bf;\n  }\n  \n  .el-carousel__item:nth-child(2n+1) {\n    background-color: #d3dce6;\n  }\n  .time {\n    font-size: 13px;\n    color: #999;\n  }\n  \n  .bottom {\n    margin-top: 13px;\n    line-height: 12px;\n  }\n\n  .button {\n    padding: 0;\n    float: right;\n  }\n\n  .image {\n    width: 100%;\n    display: block;\n  }\n\n  .clearfix:before,\n  .clearfix:after {\n      display: table;\n      content: \"\";\n  }\n  \n  .clearfix:after {\n      clear: both\n  }\n</style>\n"]}]}