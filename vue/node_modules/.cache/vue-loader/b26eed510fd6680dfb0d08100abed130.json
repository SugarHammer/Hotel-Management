{"remainingRequest":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\GitHub\\smart-hotel\\vue\\src\\views\\Engineer.vue?vue&type=style&index=0&id=f56b7dae&lang=css","dependencies":[{"path":"E:\\GitHub\\smart-hotel\\vue\\src\\views\\Engineer.vue","mtime":1677823056453},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgLmVsLWNhcm91c2VsX19pdGVtOm50aC1jaGlsZCgybikgewogICAgYmFja2dyb3VuZC1jb2xvcjogIzk5YTliZjsKICB9CiAgCiAgLmVsLWNhcm91c2VsX19pdGVtOm50aC1jaGlsZCgybisxKSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDNkY2U2OwogIH0KICAudGltZSB7CiAgICBmb250LXNpemU6IDEzcHg7CiAgICBjb2xvcjogIzk5OTsKICB9CiAgCiAgLmJvdHRvbSB7CiAgICBtYXJnaW4tdG9wOiAxM3B4OwogICAgbGluZS1oZWlnaHQ6IDEycHg7CiAgfQoKICAuYnV0dG9uIHsKICAgIHBhZGRpbmc6IDA7CiAgICBmbG9hdDogcmlnaHQ7CiAgfQoKICAuaW1hZ2UgewogICAgd2lkdGg6IDEwMCU7CiAgICBkaXNwbGF5OiBibG9jazsKICB9CgogIC5jbGVhcmZpeDpiZWZvcmUsCiAgLmNsZWFyZml4OmFmdGVyIHsKICAgICAgZGlzcGxheTogdGFibGU7CiAgICAgIGNvbnRlbnQ6ICIiOwogIH0KICAKICAuY2xlYXJmaXg6YWZ0ZXIgewogICAgICBjbGVhcjogYm90aAogIH0K"},{"version":3,"sources":["E:\\GitHub\\smart-hotel\\vue\\src\\views\\Engineer.vue"],"names":[],"mappings":";EAwQE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IAC/B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3B;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACjC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3B;EACA,CAAC,CAAC,CAAC,CAAC,EAAE;IACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACnB;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;IACV,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACd;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACL,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAChB;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EACf;;EAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACd","file":"E:/GitHub/smart-hotel/vue/src/views/Engineer.vue","sourceRoot":"","sourcesContent":["<template>\n  <div style=\"padding: 10px\">\n    <!--    搜索区域-->\n    <div style=\"margin: 10px 0\">\n      <el-divider content-position=\"left\">查询条件</el-divider>\n      <span>报修内容：</span><el-input v-model=\"search\" placeholder=\"请输入报修内容\" style=\"width: 30%\" clearable></el-input>\n      <el-button type=\"primary\" style=\"margin-left: 5px\" @click=\"findall\">查询<i class=\"el-icon-search el-icon--right\"></i></el-button>\n      <el-button @click=\"drawer = true\" type=\"primary\" style=\"margin-left: 16px;\">\n        用户报修\n      </el-button>\n    </div>\n\n    <el-divider content-position=\"left\">报修列表</el-divider>\n    <el-tabs v-model=\"searchState\" type=\"card\" @tab-click=\"findall\">\n      <el-tab-pane label=\"未分配维修员\" name=\"0\"></el-tab-pane>\n      <el-tab-pane label=\"维修未完成\" name=\"1\"></el-tab-pane>\n      <el-tab-pane label=\"维修已完成\" name=\"2\"></el-tab-pane>\n    </el-tabs>\n    <el-table\n    :data=\"contract\"\n    border\n    stripe\n    style=\"width: 100%\">\n    <el-table-column\n      fixed\n      prop=\"id\"\n      label=\"ID\"\n      width=\"100\"\n      sortable>\n    </el-table-column>\n    <el-table-column\n      prop=\"userName\"\n      label=\"报修人\">\n    </el-table-column>\n    <el-table-column\n      prop=\"text\"\n      label=\"报修内容\">\n    </el-table-column>\n    <el-table-column\n      prop=\"createTime\"\n      label=\"报修时间\"\n      width=\"150\">\n    </el-table-column>\n    <el-table-column\n      prop=\"finishTime\"\n      label=\"结束时间\"\n      width=\"150\">\n    </el-table-column>\n    <el-table-column\n      prop=\"adminName\"\n      label=\"管理员\">\n    </el-table-column>\n    <el-table-column\n      prop=\"apartmentName\"\n      label=\"酒店名\">\n    </el-table-column>\n    <el-table-column\n      prop=\"roomName\"\n      label=\"房间号\">\n    </el-table-column>\n    <el-table-column\n      prop=\"engineerName\"\n      label=\"维修员\">\n    </el-table-column>\n    <el-table-column label=\"操作\" width=\"240\">\n        <template #default=\"scope\">\n          <el-button v-if=\"scope.row.state === 0 && (userform.roles[0] === 1 || userform.roles[0] === 4)\" size=\"mini\" type=\"primary\" plain @click=\"handleEdit(scope.row)\">分配维修员</el-button>\n          <el-popconfirm title=\"确定结束维修吗？\"  v-if=\"scope.row.state != 2 && (userform.roles[0] === 1 || userform.roles[0] === 3)\" @confirm=\"overEdit(scope.row)\">\n            <template #reference>\n              <el-button size=\"mini\" type=\"primary\" plain>结束维修</el-button>\n            </template>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n\n  <div style=\"margin: 10px 0\">\n      <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"currentPage\"\n          :page-sizes=\"[5, 10, 20]\"\n          :page-size=\"pageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\">\n      </el-pagination>\n  </div>\n\n <el-drawer\n  title=\"用户报修中心\"\n  :before-close=\"handleClose\"\n  v-model=\"drawer\"\n  direction=\"rtl\"\n  size=\"60%\"\n  custom-class=\"demo-drawer\"\n  ref=\"drawer\"\n  >\n      <el-card>\n        <el-form ref=\"form\" :model=\"form\" label-width=\"120px\">\n          <el-form-item label=\"用户报修中心\">\n          </el-form-item>\n          <el-form-item label=\"报修原因填写\">\n            <el-input\n                type=\"textarea\"\n                :autosize=\"{ minRows: 2, maxRows: 4}\"\n                placeholder=\"请输入内容\"\n                v-model=\"form.text\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div style=\"text-align: center\">\n          <el-button type=\"primary\" style=\"width: 80%; margin: 10px\" @click=\"saveEngineers\">报  修</el-button>\n        </div>\n      </el-card>\n  </el-drawer>\n\n  <el-dialog title=\"报修\" v-model=\"dialogVisible\" width=\"30%\">\n      <el-form :model=\"engineerform\" label-width=\"120px\">\n        <el-form-item label=\"选择维修人员\">\n            <el-select v-model=\"engineerform.engineerId\" \n              placeholder=\"试试搜索：用户名\"\n              :options=\"options\"\n              filterable\n              style=\"width: 90%; margin: 10px\">\n              <el-option v-for=\"item in this.engineers\" :key=\"item.id\" :label=\"item.nickname\" :value=\"item.id\"></el-option>\n            </el-select>\n          </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"dialogVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"updateEdit\">确 定</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\n  export default {\n    name: 'Engineer',\n    components: {},\n    data() {\n      return {\n        dialogVisible: false,\n        loading: true,\n        drawer: false,\n        search: '',\n        searchState: '0',\n        form: {\n          roomId: '',\n          userId: '',\n          text: '',\n          engineerId: ''\n        },\n\n        userform: {},\n        engineerform: {\n          id: '',\n          engineerId: '',\n          state: '',\n        },\n        room:[],\n        engineers: [],\n        contract: [],\n      }\n    },\n    watch: {\n      'form.roomId':{\n        handler(val){\n          this.findRoom(val)\n        },\n      },\n      deep: true,\n      immediate: true\n    },\n    created() {\n      let str = sessionStorage.getItem(\"user\") || \"{}\"\n      this.userform = JSON.parse(str)\n      this.findall();\n      this.findallengineer();\n    },\n    methods: {\n      findall(){\n        this.loading = true\n          request.get(\"/engineer/all\", {\n            params: {\n              pageNum: this.currentPage,\n              pageSize: this.pageSize,\n              search: this.search,\n              state: this.searchState,\n              adminId: this.userform.id                                                                                                                                                                                                                                                                                                    \n            }\n          }).then(res => {\n            this.loading = false\n            this.contract = res.data.records\n            this.total = res.data.total\n          })\n      },\n      findRoom(id){\n        console.log(id)\n        request.get(\"/room/\"+id).then(res => {\n             this.room = res.data\n          })\n      },\n      findallengineer(){\n        request.get(\"/engineer/allEngineer\").then(res => {\n             this.engineers = res.data\n          })\n      },\n      handleEdit(row) {\n        this.engineerform.id = row.id\n        this.engineerform = JSON.parse(JSON.stringify(row))\n        this.dialogVisible = true\n      },\n      updateEdit(){\n        this.engineerform.state = '1'\n        request.put(\"/engineer/update\", this.engineerform).then(res => {\n          if (res.code === '0') {\n            this.$message.success(\"更新维修状态成功\")\n          }\n          \n        })\n        dialogVisible = false\n        this.findall()\n      },\n      overEdit(row){\n        this.engineerform.id = row.id\n        this.engineerform.state = '2'\n        request.put(\"/engineer/update\", this.engineerform).then(res => {\n          if (res.code === '0') {\n            this.$message.success(\"更新维修状态成功\")\n          }\n        })\n        this.findall()\n      },\n      onInput() {\n        this.$forceUpdate();\n      },\n      saveEngineers(){\n        this.form.userId = this.userform.id\n        request.post(\"/engineer/add\",this.form).then(res => {\n            console.log(res)\n            if (res.code === '0') {\n              this.$message({\n                type: \"success\",\n                message: \"报修成功\"\n              })\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              })\n            }\n        })\n        this.drawer = false\n        this.findall()\n      }\n    }\n  }\n</script>\n\n<style>\n  .el-carousel__item:nth-child(2n) {\n    background-color: #99a9bf;\n  }\n  \n  .el-carousel__item:nth-child(2n+1) {\n    background-color: #d3dce6;\n  }\n  .time {\n    font-size: 13px;\n    color: #999;\n  }\n  \n  .bottom {\n    margin-top: 13px;\n    line-height: 12px;\n  }\n\n  .button {\n    padding: 0;\n    float: right;\n  }\n\n  .image {\n    width: 100%;\n    display: block;\n  }\n\n  .clearfix:before,\n  .clearfix:after {\n      display: table;\n      content: \"\";\n  }\n  \n  .clearfix:after {\n      clear: both\n  }\n</style>\n"]}]}