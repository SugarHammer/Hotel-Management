{"remainingRequest":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\babel-loader\\lib\\index.js!E:\\GitHub\\smart-hotel\\vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\GitHub\\smart-hotel\\vue\\src\\views\\Message.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\GitHub\\smart-hotel\\vue\\src\\views\\Message.vue","mtime":1653969029000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitHub\\smart-hotel\\vue\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJlcXVlc3QgZnJvbSAiQC91dGlscy9yZXF1ZXN0IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNZXNzYWdlIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcjoge30sCiAgICAgIG1lc3NhZ2VzOiBbXSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICBpc0NvbGxhcHNlOiBmYWxzZSwKICAgICAgZW50aXR5OiB7fQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VyIikgPyBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkgOiB7fTsKICAgIHRoaXMubG9hZE1lc3NhZ2UoKTsKICAgIGNvbnNvbGUubG9nKHRoaXMudXNlcik7CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2FkTWVzc2FnZTogZnVuY3Rpb24gbG9hZE1lc3NhZ2UoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyDlpoLmnpzmmK/nlZnoqIDnmoTor53vvIzlsLHlhpnmrbs9MAogICAgICAvLyDlpoLmnpzmmK8g6K+E6K6677yM5YiZ6ZyA6KaB6K6+572uIOW9k+WJjeiiq+ivhOiuuueahOaooeWdl+eahGlk5L2c5Li6Zm9yZWlnbklkCiAgICAgIHZhciBmb3JlaWduSWQgPSAwOwogICAgICByZXF1ZXN0LmdldCgiL21lc3NhZ2UvZm9yZWlnbi8iICsgZm9yZWlnbklkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy5tZXNzYWdlcyA9IHJlcy5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBjYW5jZWw6IGZ1bmN0aW9uIGNhbmNlbCgpIHsKICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmVudGl0eSA9IHt9OwogICAgfSwKICAgIHJlUmVwbHk6IGZ1bmN0aW9uIHJlUmVwbHkoaWQpIHsKICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMuZW50aXR5LnBhcmVudElkID0gaWQ7CiAgICB9LAogICAgcmVwbHk6IGZ1bmN0aW9uIHJlcGx5KCkgewogICAgICB0aGlzLmVudGl0eS5jb250ZW50ID0gdGhpcy5lbnRpdHkucmVwbHk7CiAgICAgIHRoaXMuc2F2ZSgpOwogICAgfSwKICAgIHNhdmU6IGZ1bmN0aW9uIHNhdmUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLnVzZXIudXNlcm5hbWUpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICLor7fnmbvlvZUiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuZW50aXR5LmNvbnRlbnQpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICLor7floavlhpnlhoXlrrkiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOWmguaenOaYr+ivhOiuuueahOivne+8jOWcqCBzYXZl55qE5pe25YCZ6KaB5rOo5oSP6K6+572uIOW9k+WJjeaooeWdl+eahGlk5Li6IGZvcmVpZ25JZOOAguS5n+WwseaYryAgZW50aXR5LmZvcmVpZ25JZCA9IOaooeWdl2lkCgoKICAgICAgcmVxdWVzdC5wb3N0KCIvbWVzc2FnZSIsIHRoaXMuZW50aXR5KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLmNvZGUgPT09ICcwJykgewogICAgICAgICAgX3RoaXMyLiRtZXNzYWdlKHsKICAgICAgICAgICAgbWVzc2FnZTogIuivhOiuuuaIkOWKnyIsCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMi4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMyLmVudGl0eSA9IHt9OwoKICAgICAgICBfdGhpczIubG9hZE1lc3NhZ2UoKTsKCiAgICAgICAgX3RoaXMyLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGRlbDogZnVuY3Rpb24gZGVsKGlkKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmVxdWVzdC5kZWxldGUoIi9tZXNzYWdlLyIgKyBpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICLliKDpmaTmiJDlip8iLAogICAgICAgICAgdHlwZTogInN1Y2Nlc3MiCiAgICAgICAgfSk7CgogICAgICAgIF90aGlzMy5sb2FkTWVzc2FnZSgpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["E:\\GitHub\\smart-hotel\\vue\\src\\views\\Message.vue"],"names":[],"mappings":"AA8CA,OAAO,OAAP,MAAoB,iBAApB;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,SADO;AAEb,EAAA,IAFa,kBAEN;AACL,WAAO;AACL,MAAA,IAAI,EAAE,EADD;AAEL,MAAA,QAAQ,EAAE,EAFL;AAGL,MAAA,iBAAiB,EAAE,KAHd;AAIL,MAAA,UAAU,EAAE,KAJP;AAKL,MAAA,MAAM,EAAE;AALH,KAAP;AAOD,GAVY;AAWb,EAAA,OAXa,qBAWH;AACR,SAAK,IAAL,GAAY,cAAc,CAAC,OAAf,CAAuB,MAAvB,IAAiC,IAAI,CAAC,KAAL,CAAW,cAAc,CAAC,OAAf,CAAuB,MAAvB,CAAX,CAAjC,GAA8E,EAA1F;AACA,SAAK,WAAL;AACA,IAAA,OAAO,CAAC,GAAR,CAAY,KAAK,IAAjB;AAED,GAhBY;AAiBb,EAAA,OAAO,EAAE;AACP,IAAA,WADO,yBACO;AAAA;;AACZ;AACA;AACA,UAAI,SAAQ,GAAI,CAAhB;AACA,MAAA,OAAO,CAAC,GAAR,CAAY,sBAAsB,SAAlC,EAA6C,IAA7C,CAAkD,UAAA,GAAE,EAAK;AACvD,QAAA,KAAI,CAAC,QAAL,GAAgB,GAAG,CAAC,IAApB;AACD,OAFD;AAGD,KARM;AASP,IAAA,MATO,oBASE;AACP,WAAK,iBAAL,GAAyB,KAAzB;AACA,WAAK,MAAL,GAAc,EAAd;AACD,KAZM;AAaP,IAAA,OAbO,mBAaC,EAbD,EAaK;AACV,WAAK,iBAAL,GAAyB,IAAzB;AACA,WAAK,MAAL,CAAY,QAAZ,GAAuB,EAAvB;AACD,KAhBM;AAiBP,IAAA,KAjBO,mBAiBC;AACN,WAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,MAAL,CAAY,KAAlC;AACA,WAAK,IAAL;AACD,KApBM;AAsBP,IAAA,IAtBO,kBAsBA;AAAA;;AACL,UAAI,CAAC,KAAK,IAAL,CAAU,QAAf,EAAyB;AACvB,aAAK,QAAL,CAAc;AACZ,UAAA,OAAO,EAAE,KADG;AAEZ,UAAA,IAAI,EAAE;AAFM,SAAd;AAIA;AACF;;AACA,UAAI,CAAC,KAAK,MAAL,CAAY,OAAjB,EAA0B;AACxB,aAAK,QAAL,CAAc;AACZ,UAAA,OAAO,EAAE,OADG;AAEZ,UAAA,IAAI,EAAE;AAFM,SAAd;AAIA;AACF,OAdK,CAeL;;;AACA,MAAA,OAAO,CAAC,IAAR,CAAa,UAAb,EAAyB,KAAK,MAA9B,EAAsC,IAAtC,CAA2C,UAAA,GAAE,EAAK;AAChD,YAAI,GAAG,CAAC,IAAJ,KAAa,GAAjB,EAAsB;AACpB,UAAA,MAAI,CAAC,QAAL,CAAc;AACZ,YAAA,OAAO,EAAE,MADG;AAEZ,YAAA,IAAI,EAAE;AAFM,WAAd;AAIF,SALA,MAKO;AACL,UAAA,MAAI,CAAC,QAAL,CAAc;AACZ,YAAA,OAAO,EAAE,GAAG,CAAC,GADD;AAEZ,YAAA,IAAI,EAAE;AAFM,WAAd;AAIF;;AACA,QAAA,MAAI,CAAC,MAAL,GAAc,EAAd;;AACA,QAAA,MAAI,CAAC,WAAL;;AACA,QAAA,MAAI,CAAC,iBAAL,GAAyB,KAAzB;AACD,OAfD;AAgBD,KAtDM;AAuDP,IAAA,GAvDO,eAuDH,EAvDG,EAuDC;AAAA;;AACN,MAAA,OAAO,CAAC,MAAR,CAAe,cAAc,EAA7B,EAAiC,IAAjC,CAAsC,UAAA,GAAE,EAAK;AAC3C,QAAA,MAAI,CAAC,QAAL,CAAc;AACZ,UAAA,OAAO,EAAE,MADG;AAEZ,UAAA,IAAI,EAAE;AAFM,SAAd;;AAIA,QAAA,MAAI,CAAC,WAAL;AACD,OAND;AAOF;AA/DO;AAjBI,CAAf","sourcesContent":["<template>\n  <div style=\"margin-top: 10px; margin-bottom: 80px\">\n    <el-card>\n      <div style=\"padding: 20px; color: #888\">\n        <div>\n          <el-input type=\"textarea\" :rows=\"3\" v-model=\"entity.content\"></el-input>\n          <div style=\"text-align: right; padding: 10px\"><el-button type=\"primary\" @click=\"save\">留言</el-button></div>\n        </div>\n      </div>\n\n      <div style=\"display: flex; padding: 20px\" v-for=\"item in messages\" :key=\"item\">\n        <div style=\"text-align: center; flex: 1\">\n          <el-image :src=\"item.avatar\" style=\"width: 60px; height: 60px; border-radius: 50%\"></el-image>\n        </div>\n        <div style=\"padding: 0 10px; flex: 5\">\n          <div><b style=\"font-size: 14px\">{{ item.username }}</b></div>\n          <div style=\"padding: 10px 0; color: #888\">\n            {{ item.content }}\n            <el-button type=\"text\" size=\"mini\" @click=\"del(item.id)\" v-if=\"item.username === user.username || user.roles[0] === 1\">删除</el-button>\n          </div>\n          <div style=\"background-color: #eee; padding: 10px\" v-if=\"item.parentMessage\">{{ item.username }}：{{ item.parentMessage.content }}</div>\n          <div style=\"color: #888; font-size: 12px\">\n            <span>{{ item.time  }}</span>\n            <el-button type=\"text\" style=\"margin-left: 20px\" @click=\"reReply(item.id)\">回复</el-button>\n          </div>\n        </div>\n      </div>\n\n      <el-dialog title=\"回复信息\" v-model=\"dialogFormVisible\" width=\"30%\">\n        <el-form :model=\"entity\" label-width=\"80px\">\n          <el-form-item label=\"内容\">\n            <el-input v-model=\"entity.reply\" autocomplete=\"off\" type=\"textarea\" :rows=\"3\"></el-input>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n          <el-button @click=\"cancel\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"reply\">确 定</el-button>\n        </template>\n      </el-dialog>\n    </el-card>\n\n\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\nexport default {\n  name: \"Message\",\n  data() {\n    return {\n      user: {},\n      messages: [],\n      dialogFormVisible: false,\n      isCollapse: false,\n      entity: {}\n    }\n  },\n  created() {\n    this.user = sessionStorage.getItem(\"user\") ? JSON.parse(sessionStorage.getItem(\"user\")) : {};\n    this.loadMessage();\n    console.log(this.user)\n\n  },\n  methods: {\n    loadMessage() {\n      // 如果是留言的话，就写死=0\n      // 如果是 评论，则需要设置 当前被评论的模块的id作为foreignId\n      let foreignId = 0;\n      request.get(\"/message/foreign/\" + foreignId).then(res => {\n        this.messages = res.data;\n      })\n    },\n    cancel() {\n      this.dialogFormVisible = false;\n      this.entity = {};\n    },\n    reReply(id) {\n      this.dialogFormVisible = true;\n      this.entity.parentId = id;\n    },\n    reply() {\n      this.entity.content = this.entity.reply;\n      this.save();\n    },\n\n    save() {\n      if (!this.user.username) {\n        this.$message({\n          message: \"请登录\",\n          type: \"warning\"\n        });\n        return;\n      }\n      if (!this.entity.content) {\n        this.$message({\n          message: \"请填写内容\",\n          type: \"warning\"\n        });\n        return;\n      }\n      // 如果是评论的话，在 save的时候要注意设置 当前模块的id为 foreignId。也就是  entity.foreignId = 模块id\n      request.post(\"/message\", this.entity).then(res => {\n        if (res.code === '0') {\n          this.$message({\n            message: \"评论成功\",\n            type: \"success\"\n          });\n        } else {\n          this.$message({\n            message: res.msg,\n            type: \"error\"\n          });\n        }\n        this.entity = {}\n        this.loadMessage();\n        this.dialogFormVisible = false;\n      })\n    },\n    del(id) {\n      request.delete(\"/message/\" + id).then(res => {\n        this.$message({\n          message: \"删除成功\",\n          type: \"success\"\n        });\n        this.loadMessage()\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":""}]}